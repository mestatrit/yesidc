<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0062)https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" xml:lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Linux服务器集群系统(三)</title>
<meta http-equiv="PICS-Label" content="(PICS-1.1 &quot;http://www.icra.org/ratingsv02.html&quot; l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) &quot;http://www.rsac.org/ratingsv01.html&quot; l gen true r (n 0 s 0 v 0 l 0) &quot;http://www.classify.org/safesurf/&quot; l gen true r (SS~~000 1))">
<link rel="schema.DC" href="http://purl.org/DC/elements/1.0/">
<link rel="SHORTCUT ICON" href="http://www.ibm.com/favicon.ico">
  <meta name="Owner" content="dw@cn.ibm.com">
  <meta name="DC.Language" scheme="rfc1766" content="zh-CN">
  <meta name="IBM.Country" content="CN">
<meta name="Security" content="Public">
<meta name="IBM.SpecialPurpose" content="SP001">
<meta name="IBM.PageAttributes" content="sid=1003">
<meta name="Source" content="v16 Template Generator">
<meta name="Robots" content="index,follow">
<meta name="Abstract" content="本文在分析服务器集群实现虚拟网络服务的相关技术上，详细描述了LVS集群中实现的三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）的工作原理，以及它们的优缺点。">
<meta name="Description" content="本文在分析服务器集群实现虚拟网络服务的相关技术上，详细描述了LVS集群中实现的三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）的工作原理，以及它们的优缺点。">
<meta name="Keywords" content="LVS, 集群, IP, 负载均衡, VS/NAT, VS/TUN, VS/DR, 章文嵩 ,linux tutorials, linux training, linux standards, linux code, linux resources, linux programming, open source standards, linux how to,, tttlca">
<meta name="DC.Date" scheme="iso8601" content="2002-04-10">
<meta name="DC.Type" scheme="IBM_ContentClassTaxonomy" content="CT316">
<meta name="DC.Subject" scheme="IBM_SubjectTaxonomy" content="SWGC0">
<meta scheme="IBM_WTMCategory" name="IBM.WTMCategory" content="SOFDCLNXCN">
<meta name="DC.Rights" content="© Copyright IBM Corporation 2002">
<meta name="IBM.Effective" scheme="W3CDTF" content="2002-04-10">
<meta name="title" content="Linux服务器集群系统(三)">

<!-- HEADER_SCRIPTS_AND_CSS_INCLUDE -->
<link href="./Linux服务器集群系统(三)_files/all.css" media="all" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/screen.css" media="screen,projection" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/screen-uas.css" media="screen,projection" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/screen-fonts.css" media="screen,projection" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/handheld.css" media="handheld" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/print.css" media="print" rel="stylesheet" title="www" type="text/css">
<!-- dW-specific CSS -->
<link href="./Linux服务器集群系统(三)_files/dw-screen.css" media="screen,projection" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/dw-local-site.css" media="screen,projection" rel="stylesheet" title="www" type="text/css">
<link href="./Linux服务器集群系统(三)_files/jquery.cluetip.css" media="screen,projection" rel="stylesheet" title="www" type="text/css">

<script src="./Linux服务器集群系统(三)_files/ibmcommon.js" type="text/javascript">//</script><link rel="search" type="application/opensearchdescription+xml" href="http://www.ibm.com/search/opensearch/description.xml" title="IBM Search">
<script src="./Linux服务器集群系统(三)_files/dynamicnav.js" type="text/javascript">//</script>
<!-- Pull-down script --> 
<script type="text/javascript" src="./Linux服务器集群系统(三)_files/dropdown.js">//</script>
<!-- dW functional JS -->
<script language="JavaScript" src="./Linux服务器集群系统(三)_files/urltactic.js" type="text/javascript"></script>
<!-- Rating_START -->

<script language="JavaScript" type="text/javascript">
  // <![CDATA[

 dwr = {};
  dwr.clickhere = '点击评分';
  dwr.stars = '星';
  dwr.star = '星'; 
  dwr.avgRatingOf = '平均分';
  dwr.youRated = '您的评分是';
  dwr.avgRating = '平均分';
  dwr.basedOnVote = '共 {1} 个评分'; // {1} to be substitue by code
  dwr.basedOnVotes = '共 {1} 个评分';
  dwr.leftParen = '（'; 
  dwr.rightParen = ' ）'; 
  dwr.space = ' '; 
  dwr.yourRating = '您的评分';

// ]]>
</script>


<script language="JavaScript" src="./Linux服务器集群系统(三)_files/artrating.js" type="text/javascript"></script>
<style type="text/css">
.metavalue {
  display: none;
}
</style>
<!-- Rating_END --><!-- RESERVED_HEADER_INCLUDE -->
<script language="javascript" src="./Linux服务器集群系统(三)_files/ajax1.js" type="text/javascript"></script>
<script language="javascript" src="./Linux服务器集群系统(三)_files/search_counter-maverick.js" type="text/javascript"></script>
<script language="javascript" src="./Linux服务器集群系统(三)_files/request_referer_capture-maverick.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
 <!--
 setDefaultQuery('defaultHere');
 //-->
</script>
<script language="JavaScript" type="text/javascript">
 <!--
 function openNewWindow(url,tar,arg){window.open(url,tar,arg);}
 //-->
</script>
  <!-- Include file support -->
  <script language="JavaScript" type="text/javascript">
    (function($) {
    jQuery.extend({
    getInc: function(u,d){
    if(u==null)return;
    jQuery.ajax({
    type: "GET",
    url: u,
    dataType: "text",
    success: function(t) {
    jQuery(d).html(t);
    ibmCommon.initShowHide(jQuery(d).children()[0]);	
    },
    async: true
    });
    }
    });
    })(jQuery);
  </script>
<script id="flashdetect" type="text/javascript" src="./Linux服务器集群系统(三)_files/flash-detect.js" charset="UTF-8"></script><script id="mhMenu" type="text/javascript" src="./Linux服务器集群系统(三)_files/cnzh-utf8.js" charset="UTF-8"></script><script id="dynavEA" type="text/javascript" src="./Linux服务器集群系统(三)_files/Controller" charset="UTF-8"></script><script id="wiBundle" type="text/javascript" src="./Linux服务器集群系统(三)_files/Controller(1)" charset="UTF-8"></script></head>

<body id="ibm-com">
<div id="ibm-top" class="ibm-landing-page">

<!-- MASTHEAD_BEGIN -->
<div class="ibm-access"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#main">跳转到主要内容</a></div><div id="ibm-masthead"><div id="ibm-logo"><a href="http://www.ibm.com/cn/zh/"><img width="110" src="./Linux服务器集群系统(三)_files/ibm-logo.gif" height="50" alt="IBM®"></a></div><ul id="ibm-geo"><li class="ibm-first" id="ibm-country">中国</li><li id="ibm-change-country">[ <a href="http://www.ibm.com/developerworks/cn/country/">选择</a> ]</li></ul><form id="ibm-search-form" action="https://www.ibm.com/developerworks/search/searchResults.jsp" method="get" name="form1"><input type="hidden" name="searchType" value="1"><input type="hidden" name="searchSite" value="dWChina"><input type="hidden" name="pageLang" value="zh"><input type="hidden" name="langEncoding" value="UTF8"><p><span id="ibm-search-scope"><label for="sn"><img src="./Linux服务器集群系统(三)_files/c.gif" width="1" height="1" alt="Search in:"></label><select class="input-local" name="searchScope" id="sn" size="1"><option value="dW" selected="selected">dW 全部内容</option><option value="dW">--------------</option><option value="aixunix">&nbsp;&nbsp;AIX and UNIX</option><option value="dmdd">&nbsp;&nbsp;Info Mgmt</option><option value="lotusdd">&nbsp;&nbsp;Lotus</option><option value="rdd">&nbsp;&nbsp;Rational</option><option value="wsdd">&nbsp;&nbsp;WebSphere</option><option value="dW">--------------</option><option value="javaZ">&nbsp;&nbsp;Java technology</option><option value="linuxZ">&nbsp;&nbsp;Linux</option><option value="opensrcZ">&nbsp;&nbsp;Open source</option><option value="webservZ">&nbsp;&nbsp;SOA &amp; Web services</option><option value="webarchZ">&nbsp;&nbsp;Web dev</option><option value="xmlZ">&nbsp;&nbsp;XML</option><option value="dW">--------------</option><option value="all">IBM 全部内容</option></select></span><label for="q"><img alt="搜索:" height="1" width="1" src="./Linux服务器集群系统(三)_files/c.gif"></label><input type="text" name="query" maxlength="100" id="q"><input type="submit" id="ibm-search" class="ibm-btn-search" name="Search" value="搜索"></p></form><div id="ibm-site-name"><!-- IBM site name container --></div><div id="ibm-universal-nav"><ul><li class="ibm-first" id="ibm-unav-home"><a href="http://www.ibm.com/cn/zh/">首页</a></li><li id="ibm-unav-solutions"><a href="http://www.ibm.com/solutions/cn/zh/" class=" ibm-unav-has-child">解决方案</a><div class="ibm-unav-menu" id="gi-c2aca31e"><span class="ibm-unav-menu-ehb" id="gi-c2aca31e-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-f2e69563-trigger">按行业分类</a><div class="ibm-unav-menu ibm-place-holder" id="gi-f2e69563"><span class="ibm-unav-menu-ehb" id="gi-f2e69563-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/industry/finance/solution/">金融业</a></li><li><a href="http://www.ibm.com/cn/industry/finance/solution/banking.shtml">银行业</a></li><li><a href="http://www.ibm.com/cn/industry/finance/solution/insurance.shtml">保险业</a></li><li><a href="http://www.ibm.com/smb/cn/industries/retail/index.shtml?ca=masterhead&me=cndotcom">零售业</a></li><li><a href="http://www.ibm.com/smb/cn/industries/manufacture/index.shtml?ca=masterhead&me=cndotcom">制造业</a></li><li><a href="http://www.ibm.com/cn/smb/industries/manu/food_sub.shtml?ca=masterhead&me=cndotcom">日常消费品</a></li><li><a href="http://www.ibm.com/cn/smb/industries/manu/tobacco_sub.shtml?ca=masterhead&me=cndotcom">饮料烟草</a></li><li><a href="http://www.ibm.com/cn/industry/distribution/solution/">流通业</a></li><li><a href="http://www.ibm.com/cn/industry/industrial/solution/solu_commu.shtml">电子行业</a></li><li><a href="http://www.ibm.com/cn/industry/telecom/solution/">电信业</a></li><li><a href="http://www.ibm.com/cn/smb/industries/media/index.shtml?ca=masterhead&me=cndotcom">媒体与娱乐业</a></li><li><a href="http://www.ibm.com/cn/industry/distribution/solution/transport.shtml">交通运输业</a></li><li><a href="http://www.ibm.com/cn/industry/industrial/solution/solu_aero.shtml">航空航天造船业</a></li><li><a href="http://www.ibm.com/cn/industry/industrial/solution/solu_auto.shtml">汽车制造业</a></li><li><a href="http://www.ibm.com/cn/industry/industrial/solution/solu_petro.shtml">石油石化业</a></li><li><a href="http://www.ibm.com/cn/public/offertogov/h/">政府与公众事业</a></li><li><a href="http://www.ibm.com/cn/industry/education/solution/">教育</a></li><li><a href="http://www.ibm.com/cn/public/healthcare/solutions/">医疗与生命科学</a></li></ul></div></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-6e26845f-trigger">按业务需求分类</a><div class="ibm-unav-menu ibm-place-holder" id="gi-6e26845f"><span class="ibm-unav-menu-ehb" id="gi-6e26845f-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/smb/cn/business/infrastructure/index.shtml?ca=masterhead&me=cndotcom">IT 基础架构解决方案</a></li><li><a href="http://www.ibm.com/cn/smb/solutions/bi/index.shtml?ca=masterhead&me=cndotcom">商务智能（BI）</a></li><li><a href="http://www.ibm.com/cn/express/business/scm/index.shtml?ca=masterhead&me=cndotcom">供应链管理（SCM）</a></li><li><a href="http://www.ibm.com/cn/express/business/erp/index.shtml?ca=masterhead&me=cndotcom">企业资源规划（ERP）</a></li><li><a href="http://www.ibm.com/cn/smb/solutions/crm/index.shtml?ca=masterhead&me=cndotcom">客户关系管理（CRM）</a></li><li><a href="http://www.ibm.com/cn/smb/solutions/plm/index.shtml?ca=masterhead&me=cndotcom">产品生命周期管理（PLM）</a></li><li><a href="http://www.ibm.com/cn/express/business/oa/index.shtml?ca=masterhead&me=cndotcom">办公自动化(OA)</a></li><li><a href="http://www.ibm.com/cn/express/business/eam/index.shtml?ca=masterhead&me=cndotcom">企业资产管理(EAM)</a></li><li><a href="http://www.ibm.com/software/cn/db2/content-management/industry-solutions/">内容管理</a></li><li><a href="http://www.ibm.com/cn/software/solution/info_conformity.html">信息集成</a></li></ul></div></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-169baaa6-trigger">按顶级业务合作伙伴分类</a><div class="ibm-unav-menu ibm-place-holder" id="gi-169baaa6"><span class="ibm-unav-menu-ehb" id="gi-169baaa6-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/services/hotsale/cisco/index.shtml">IBM 和 Cisco</a></li><li><a href="http://www.ibm.com/cn/services/bcs/alliance/oracle/index.shtml">IBM 与 Oracle</a></li><li><a href="http://www.ibm.com/cn/services/bcs/alliance/sap/index.shtml">IBM 与 SAP</a></li></ul></div></li><li><a href="http://www.ibm.com/cn/services/bcs/">业务咨询</a></li><li><a href="https://www.ibm.com/systems/cn/dihub/index.shtml">IBM 动态架构</a></li><li><a href="https://www.ibm.com/software/cn/smartwork/">IBM智慧运作</a></li><li><a href="https://www.ibm.com/software/cn/nihub/">IBM新锐洞察</a></li><li><a href="https://www.ibm.com/software/cn/spsm/">IBM智慧产品与服务</a></li><li><a href="http://www.ibm.com/software/cn/soa/launch/index.html">面向服务架构 (SOA)</a></li><li><a href="http://www.ibm.com/cn/financing/index.shtml">融资租赁</a></li><li><a href="http://www.ibm.com/smb/cn/business/index.shtml?ca=masterhead&me=cndotcom">面向中型企业及机构的解决方案</a></li><li><a href="http://www.ibm.com/software/cn/solution/">软件行业解决方案</a></li><li><a href="http://www.ibm.com/city/cn/index.shtml?re=masthead">IBM 区域解决方案</a></li><li><a href="http://www.ibm.com/cn/services/bcs/">更多业务解决方案</a></li></ul></div></li><li id="ibm-unav-services"><a href="http://www.ibm.com/technologyservices/cn/zh/" class=" ibm-unav-has-child">服务</a><div class="ibm-unav-menu" id="gi-b3b6d7cd"><span class="ibm-unav-menu-ehb" id="gi-b3b6d7cd-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-226616a2-trigger">按服务项目分类</a><div class="ibm-unav-menu ibm-place-holder" id="gi-226616a2"><span class="ibm-unav-menu-ehb" id="gi-226616a2-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www-31.ibm.com/cn/services/managedservices/">弹性运维服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/bcrs/c1000411">业务连续与灾难恢复服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/imc/c1025977">企业终端用户服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/gn/c1000412">网络服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025997">IT 策略与基础架构服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/its/c1000418">维护与技术支持服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025998">中间件服务</a></li><li><a href="http://www.ibm.com/services/cn/gts/outsourcing.html">外包服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/so/c1000405">企业 IT 安全服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1025999">服务器服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/igs/c1026000">数据中心及智能化集成服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/itservice/its/c1000416">数据与存储服务</a></li></ul></div></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-e136bd8d-trigger">按业务类型分类</a><div class="ibm-unav-menu ibm-place-holder" id="gi-e136bd8d"><span class="ibm-unav-menu-ehb" id="gi-e136bd8d-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024566">竞争策略</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024555">营运/委外</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024567">顾客服务及忠诚度</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024553">通路策略实施</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024556">IT 最适化</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024568">全新的工作环境</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024557">灵活可靠的基础建设</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024554">安全和防御</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/businesstopic/igs/a1024569">价值链效益</a></li></ul></div></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-d28d3b1c-trigger">按行业分类</a><div class="ibm-unav-menu ibm-place-holder" id="gi-d28d3b1c"><span class="ibm-unav-menu-ehb" id="gi-d28d3b1c-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024588">跨行业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024537">金融业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024548">银行业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024546">保险业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024547">零售业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024540">消费品</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024545">批发业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024550">电子业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024543">电信业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024538">媒体与娱乐</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024541">旅游和运输业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024542">汽车行业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024552">石油石化行业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024549">政府部门</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024644">能源与公用事业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024544">教育业</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024536">医疗保健</a></li><li><a href="http://www.ibm.com/services/cn/index.wss/industry/igs/a1024539">生命科学</a></li></ul></div></li><li><a href="http://www.ibm.com/training/cn/">培训服务</a></li><li><a href="http://www.ibm.com/cn/software/service/">软件服务</a></li><li><a href="http://www.ibm.com/cn/express/products/igs/?ca=masterhead&me=cndotcom">面向中型企业及机构的服务</a></li><li><a href="http://www.ibm.com/services/cn/index.wss">更多服务</a></li></ul></div></li>
<li id="ibm-unav-products"><a href="http://www.ibm.com/products/cn/zh/" class=" ibm-unav-has-child">产品</a><div class="ibm-unav-menu" id="gi-2adfa5d7"><span class="ibm-unav-menu-ehb" id="gi-2adfa5d7-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/shop/special.shtml">特惠产品和方案</a></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-7c3d87f2-trigger">软件</a><div class="ibm-unav-menu ibm-place-holder" id="gi-7c3d87f2"><span class="ibm-unav-menu-ehb" id="gi-7c3d87f2-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/software/">所有软件</a></li><li><a href="http://www.ibm.com/software/products/cn/zh">产品目录</a></li><li><a href="http://www.ibm.com/cn/software/db2/">Information Management 信息管理软件</a></li><li><a href="http://www.ibm.com/cn/software/lotus/">Lotus 协作办公软件</a></li><li><a href="http://www.ibm.com/cn/software/rational/">Rational 开发软件</a></li><li><a href="http://www.ibm.com/cn/software/tivoli/">Tivoli 服务管理软件</a></li><li><a href="http://www.ibm.com/cn/software/websphere/">WebSphere 应用系统和整合软件</a></li><li><a href="http://www.ibm.com/cn/software/zseries/">System z 服务器软件</a></li></ul></div></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-5d34ceef-trigger">Systems 与服务器</a><div class="ibm-unav-menu ibm-place-holder" id="gi-5d34ceef"><span class="ibm-unav-menu-ehb" id="gi-5d34ceef-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/systems/cn/">所有 IBM Systems 和服务器</a></li><li><a href="http://www.ibm.com/systems/cn/power/index.shtml">Power Systems</a></li><li><a href="http://www.ibm.com/cn/systems/i/index.shtml">System i （i系列）服务器</a></li><li><a href="http://www.ibm.com/cn/systems/p/">System p （p系列）服务器</a></li><li><a href="http://www.ibm.com/cn/systems/x/">System x （x系列）服务器</a></li><li><a href="http://www.ibm.com/cn/systems/z/">System z （z系列）服务器</a></li><li><a href="http://www.ibm.com/cn/systems/bladecenter/">BladeCenter 刀片服务器</a></li><li><a href="http://www.ibm.com/cn/openpower">OpenPower 服务器</a></li><li><a href="http://www.ibm.com/cn/servers/eserver/xseries/l1350.shtml">群集服务器</a></li><li><a href="http://www.ibm.com/cn/systems/unix/">UNIX 服务器</a></li><li><a href="http://www.ibm.com/cn/servers/eserver/linux/index.shtml">Linux 服务器</a></li><li><a href="http://www.ibm.com/cn/systems/power/index.shtml">POWER 处理器的服务器</a></li><li><a href="http://www.ibm.com/cn/servers/jump_intel.shtml">基于英特尔架构的服务器</a></li></ul></div></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-c069d775-trigger">存储产品</a><div class="ibm-unav-menu ibm-place-holder" id="gi-c069d775"><span class="ibm-unav-menu-ehb" id="gi-c069d775-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/storage/cn/">所有存储产品</a></li><li><a href="http://www.ibm.com/storage/cn/disk/">磁盘存储系统</a></li><li><a href="http://www.ibm.com/storage/cn/tape/">磁带存储系统</a></li><li><a href="http://www.ibm.com/storage/cn/san/">存储区域网络</a></li><li><a href="http://www.ibm.com/storage/cn/nas/">网络连接存储</a></li><li><a href="http://www.ibm.com/storage/cn/software/">存储软件</a></li><li><a href="http://www.ibm.com/storage/cn/product/index.shtml">存储产品排序（A - Z）</a></li></ul></div></li><li><a href="http://www.ibm.com/services/cn/index.wss/offerfamily/igs/c1025846">网络安全</a></li><li><a href="http://www.ibm.com/cn/products/pos/">零售终端</a></li><li><a href="http://www.infoprintsolutionscompany.com/internet/wwsites.nsf/vwWebPublished/mainT1_cn">打印机 (InfoPrint)</a></li><li><a href="http://www.ibm.com/cn/financing/icpe/">IBM 官方认证再制造设备</a></li><li><a href="http://www.ibm.com/cn/servers/eserver/xseries/options.shtml">选件</a></li><li><a href="http://www.ibm.com/cn/promotion/esg/xseries/">中低端产品特惠商城</a></li><li><a href="http://www.ibm.com/cn/express/products/hardware/index.shtml?ca=masterhead&me=cndotcom">面向中型企业及机构的特惠产品</a></li></ul></div></li>
<li id="ibm-unav-support"><a href="http://www.ibm.com/support/cn/zh/" class=" ibm-unav-has-child">支持与下载</a><div class="ibm-unav-menu" id="gi-2fa49768"><span class="ibm-unav-menu-ehb" id="gi-2fa49768-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-36ce727b-trigger">下载</a><div class="ibm-unav-menu ibm-place-holder" id="gi-36ce727b"><span class="ibm-unav-menu-ehb" id="gi-36ce727b-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/support/download/download.shtml">驱动程序和软件下载</a></li></ul></div></li><li><a href="http://www.ibm.com/support/troubleshooting/cn/">故障诊断与排除</a></li><li><a href="http://www.ibm.com/support/advsrch.wss?rs=0&loc=zh_CN">搜索</a></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-755ea7d2-trigger">按产品查看</a><div class="ibm-unav-menu ibm-place-holder" id="gi-755ea7d2"><span class="ibm-unav-menu-ehb" id="gi-755ea7d2-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/cn/support/productsupport/sw_support.shtml">软件产品</a></li><li><a href="http://www.ibm.com/cn/support/productsupport/eserver.shtml">服务器</a></li><li><a href="http://www.ibm.com/cn/support/productsupport/storage_support.shtml">存储产品</a></li><li><a href="http://www.ibm.com/cn/support/productsupport/print_support.shtml">打印机 (InfoPrint)</a></li></ul></div></li><li><a href="http://www.ibm.com/cn/support/mysupport/">个性化支持</a></li><li><a href="http://www.ibm.com/support/publications/cn/index.html">产品资料中心</a></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-2278f47d-trigger">电子化工具</a><div class="ibm-unav-menu ibm-place-holder" id="gi-2278f47d"><span class="ibm-unav-menu-ehb" id="gi-2278f47d-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/support/electronic/uprtransition.wss?category=2&locale=zh_CN">提交服务请求</a></li><li><a href="https://www.ibm.com/support/electronic/portal/!ut/p/kcxml/04_Sj9SPykssy0xPLMnMz0vM0Y_QjzKLt4y3dAXJgFku-pHIIgbxjnABX4_83FT9IKBEpDlQxCVQPyonNT0xuVI_WN9bP0C_IDc0otzb0REAowWZNg!!/delta/base64xml/L2dJQSEvUUt3QS80SVVFLzZfOV85RQ!!?category=4&locale=zh_CN">专项服务</a></li></ul></div></li><li><a href="http://www.ibm.com/cn/support/viewdoc/knowledgebase">技术知识库</a></li><li><a href="http://www.ibm.com/support/operations/cn">在线客户支持</a></li><li><a href="http://www.ibm.com/support/warranties/cn/">保修、许可和维护</a></li></ul></div></li>
<li id="ibm-unav-myibm"><a href="http://www.ibm.com/account/cn/zh/" class=" ibm-unav-has-child">个性化服务</a><div class="ibm-unav-menu" id="gi-e56d7d26"><span class="ibm-unav-menu-ehb" id="gi-e56d7d26-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/account/myaccounts/cn/zh/">我的账户</a></li><li class=" ibm-myinterest"><a href="http://www.ibm.com/account/myibm/myinterestView.do?cc=cn&lc=zh" id="gi-7d2680f2-trigger">我的收藏夹</a><div class="ibm-unav-menu ibm-myinterest" id="gi-7d2680f2"><span class="ibm-unav-menu-ehb" id="gi-7d2680f2-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul></ul></div></li><li><a href="http://www.ibm.com/account/myibm/profile.do?cc=cn&lc=zh">我的概要信息</a></li><li class=" ibm-place-holder"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" class=" ibm-unav-menu-has-child" id="gi-36011c97-trigger">客户支持</a><div class="ibm-unav-menu ibm-place-holder" id="gi-36011c97"><span class="ibm-unav-menu-ehb" id="gi-36011c97-ehb"><img alt="" src="./Linux服务器集群系统(三)_files/c(1).gif"></span><a class="ibm-access"></a><ul><li><a href="http://www.ibm.com/support/operations/cn/zh/contracts">合同</a></li><li><a href="http://www.ibm.com/support/operations/cn/zh/orderdelivery">订单与发货</a></li><li><a href="http://www.ibm.com/support/operations/cn/zh/inventory">库存与维护</a></li><li><a href="http://www.ibm.com/support/operations/cn/zh/invoicespayments">发票与付款</a></li><li><a href="http://www.ibm.com/support/operations/cn">更多客户支持</a></li></ul></div></li><li><a href="http://www.ibm.com/account/cn/zh/">了解更多</a></li></ul></div></li>
</ul>
</div>

</div>

<!-- MASTHEAD_END -->

<div id="ibm-pcon">

<!-- CONTENT_BEGIN -->
<div id="ibm-content">

<!-- Navigation_Trail_BEGIN -->
<!-- &nbsp; -->
      <div id="ibm-content-head"><ul id="ibm-navigation-trail"><li class="ibm-first"><a href="http://www.ibm.com/developerworks/cn/">developerWorks 中国</a></li><li><a href="http://www.ibm.com/developerworks/cn/linux/">Linux</a></li><li><a href="http://www.ibm.com/developerworks/cn/views/linux/libraryview.jsp">文档库</a></li></ul></div>
<!-- Navigation_Trail_END -->

<!-- dW_Summary Area_START -->
<div id="dw-summary-article">

<div class="dw-content-head">
<h1>Linux服务器集群系统(三)</h1><p><em>LVS集群中的IP负载均衡技术</em></p>
</div>

<div class="ibm-container-body ibm-two-column">

<div class="ibm-column ibm-first">
<div class="author"><a class="dwauthor" rel="#authortip1" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#author1">章文嵩</a> (<a href="mailto:wensong@linux-vs.org?subject=Linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9B%86%E7%BE%A4%E7%B3%BB%E7%BB%9F(%E4%B8%89)&cc=wensong@linux-vs.org">wensong@linux-vs.org</a>),  </div><div id="authortip1" class="dwauthor-onload-state ibm-no-print" style="display: none; ">章文嵩博士，开放源码及Linux内核的开发者，著名的Linux集群项目－－LVS(Linux Virtual
Server)的创始人和主要开发人员。他目前工作于国家并行与分布式处理重点实验室，主要从事集群技术、操作系统、对象存储与数据库的研究。他一直在自由软件的开发上花费大量时间，并以此为乐。</div>
<p></p>
  <p><b>简介：</b>&nbsp;本文在分析服务器集群实现虚拟网络服务的相关技术上，详细描述了LVS集群中实现的三种IP负载均衡技术（VS/NAT、VS/TUN和VS/DR）的工作原理，以及它们的优缺点。</p>

  <!-- <p class="ibm-no-print"><div id="dw-tag-this" class="ibm-no-print"></div><div id="interestShow" class="ibm-no-print"></div></p> -->
<div id="dw-tag-content" class="ibm-no-print"></div><div id="dw-moretags-access" class="ibm-access"></div>
<p class="ibm-no-print"></p><div id="dw-tag-this" class="ibm-no-print"><a class="ibm-external-link" onclick="jQuery.launchTagThisWindow(); return false;" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#">标记本文！</a></div><div id="interestShow" class="ibm-no-print"></div><p></p>
</div>

<div class="ibm-column ibm-second">

<p class="leading"><b>发布日期：</b>&nbsp;2002 年 4 月 10 日
  
<br><b>级别：</b>&nbsp;初级
    

<br><b>访问情况</b>&nbsp;466 次浏览
<br><b>建议:</b>&nbsp;<span id="nCmts">0&nbsp;(<a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#icomments">添加评论</a>)</span>
<!-- Rating_Area_Begin -->
<!-- Ensure that div id is based on input id and ends with -widget -->	
<input id="art-rating" name="ratinga" type="hidden" value="0"></p><div id="art-rating-widget"><a href="javascript:void(0);"><img alt="1 star" title="点击评分 1 星" height="20" src="./Linux服务器集群系统(三)_files/star-off.gif" width="20"></a><a href="javascript:void(0);"><img alt="2 stars" title="点击评分 2 星" height="20" src="./Linux服务器集群系统(三)_files/star-off.gif" width="20"></a><a href="javascript:void(0);"><img alt="3 stars" title="点击评分 3 星" height="20" src="./Linux服务器集群系统(三)_files/star-off.gif" width="20"></a><a href="javascript:void(0);"><img alt="4 stars" title="点击评分 4 星" height="20" src="./Linux服务器集群系统(三)_files/star-off.gif" width="20"></a><a href="javascript:void(0);"><img alt="5 stars" title="点击评分 5 星" height="20" src="./Linux服务器集群系统(三)_files/star-off.gif" width="20"></a><span id="rateTxt">  平均分 （共 0 个评分 ）</span></div>
<script language="JavaScript" type="text/javascript">
// <![CDATA[
 //  widget div id and article id as args
   window.artRating.init('art-rating-widget');
// ]]>
</script>
<!-- Rating_Area_End -->
<p></p>
</div>

</div>
</div>
<!-- dW_Summary_Area_END -->

<!-- CONTENT_BODY -->
<div id="ibm-content-body">

<!-- MAIN_COLUMN_BEGIN -->
<div id="ibm-content-main">

<!-- Related_Searches_Area_And_Overlays_Begin -->

<!-- MAIN_COLUMN_CONTAINER_BEGIN -->
<div class="ibm-container">

<!-- MAIN_COLUMN_CONTENT_BEGIN -->
<p><a name="1"><span class="atitle">前言</span></a></p>
      <p>在前面文章中，讲述了可伸缩网络服务的几种结构，它们都需要一个前端的负载调度器（或者多个进行主从备份）。我们先分析实现虚拟网络服务的主要技术，指出IP负载均衡技术是在负载调度器的实现技术中效率最高的。在已有的IP负载均衡技术中，主要有通过网络地址转换（Network Address Translation）将一组服务器构成一个高性能的、高可用的虚拟服务器，我们称之为VS/NAT技术（Virtual Server via Network Address Translation）。在分析VS/NAT的缺点和网络服务的非对称性的基础上，我们提出了通过IP隧道实现虚拟服务器的方法VS/TUN（Virtual Server via IP Tunneling），和通过直接路由实现虚拟服务器的方法VS/DR（Virtual Server via Direct Routing），它们可以极大地提高系统的伸缩性。VS/NAT、VS/TUN和VS/DR技术是LVS集群中实现的三种IP负载均衡技术，我们将在文章中详细描述它们的工作原理和各自的优缺点。</p>
      <p>在以下描述中，我们称客户的socket和服务器的socket之间的数据通讯为连接，无论它们是使用TCP还是UDP协议。下面简述当前用服务器集群实现高可伸缩、高可用网络服务的几种负载调度方法，并列举几个在这方面有代表性的研究项目。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link ibm-back-to-top"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a name="2"><span class="atitle">实现虚拟服务的相关方法</span></a></p>
      <p>在网络服务中，一端是客户程序，另一端是服务程序，在中间可能有代理程序。由此看来，可以在不同的层次上实现多台服务器的负载均衡。用集群解决网络服务性能问题的现有方法主要分为以下四类。</p>
      <p><a name="N10049"><span class="smalltitle">2.1. 基于RR-DNS的解决方法</span></a></p>
      
      <p>NCSA的可伸缩的WEB服务器系统就是最早基于RR-DNS（Round-Robin Domain Name System）的原型系统[1,2]。它的结构和工作流程如下图所示：</p>
      
        <br><a name="N10056"><b>图1：基于RR-DNS的可伸缩WEB服务器</b></a><br>
        <img alt="基于RR-DNS的可伸缩WEB服务器" height="542" src="./Linux服务器集群系统(三)_files/rrdns-web.jpg" width="505">
      <br><p>
(注：本图来自文献【9】)
      </p><p>有一组WEB服务器，他们通过分布式文件系统AFS(Andrew File System)来共享所有的HTML文档。这组服务器拥有相同的域名（如www.ncsa.uiuc.edu），当用户按照这个域名访问时, RR-DNS服务器会把域名轮流解析到这组服务器的不同IP地址，从而将访问负载分到各台服务器上。</p>
      <p>这种方法带来几个问题。第一，域名服务器是一个分布式系统，是按照一定的层次结构组织的。当用户就域名解析请求提交给本地的域名服务器，它会因不能直接解析而向上一级域名服务器提交，上一级域名服务器再依次向上提交，直到RR-DNS域名服器把这个域名解析到其中一台服务器的IP地址。可见，从用户到RR-DNS间存在多台域名服器，而它们都会缓冲已解析的名字到IP地址的映射,这会导致该域名服器组下所有用户都会访问同一WEB服务器，出现不同WEB服务器间严重的负载不平衡。为了保证在域名服务器中域名到IP地址的映射不被长久缓冲，RR-DNS在域名到IP地址的映射上设置一个TTL(Time To Live)值，过了这一段时间，域名服务器将这个映射从缓冲中淘汰。当用户请求，它会再向上一级域名服器提交请求并进行重新影射。这就涉及到如何设置这个TTL值，若这个值太大，在这个TTL期间，很多请求会被映射到同一台WEB服务器上，同样会导致严重的负载不平衡。若这个值太小，例如是０，会导致本地域名服务器频繁地向RR-DNS提交请求，增加了域名解析的网络流量，同样会使RR-DNS服务器成为系统中一个新的瓶颈。</p>
      <p>第二，用户机器会缓冲从名字到IP地址的映射，而不受TTL值的影响，用户的访问请求会被送到同一台WEB服务器上。由于用户访问请求的突发性和访问方式不同，例如有的人访问一下就离开了，而有的人访问可长达几个小时，所以各台服务器间的负载仍存在倾斜（Skew）而不能控制。假设用户在每个会话中平均请求数为20，负载最大的服务器获得的请求数额高于各服务器平均请求数的平均比率超过百分之三十。也就是说，当TTL值为0时，因为用户访问的突发性也会存在着较严重的负载不平衡。</p>
      <p>第三，系统的可靠性和可维护性差。若一台服务器失效，会导致将域名解析到该服务器的用户看到服务中断，即使用户按“Reload”按钮，也无济于事。系统管理员也不能随时地将一台服务器切出服务进行系统维护，如进行操作系统和应用软件升级，这需要修改RR-DNS服务器中的IP地址列表，把该服务器的IP地址从中划掉，然后等上几天或者更长的时间，等所有域名服器将该域名到这台服务器的映射淘汰，和所有映射到这台服务器的客户机不再使用该站点为止。</p>
      <p><a name="N10072"><span class="smalltitle">2.2. 基于客户端的解决方法</span></a></p>
      
      <p>基于客户端的解决方法需要每个客户程序都有一定的服务器集群的知识，进而把以负载均衡的方式将请求发到不同的服务器。例如，Netscape Navigator浏览器访问Netscape的主页时，它会随机地从一百多台服务器中挑选第N台，最后将请求送往wwwN.netscape.com。然而，这不是很好的解决方法，Netscape只是利用它的Navigator避免了RR-DNS解析的麻烦，当使用IE等其他浏览器不可避免的要进行RR-DNS解析。</p>
      <p>Smart Client[3]是Berkeley做的另一种基于客户端的解决方法。服务提供一个Java Applet在客户方浏览器中运行，Applet向各个服务器发请求来收集服务器的负载等信息，再根据这些信息将客户的请求发到相应的服务器。高可用性也在Applet中实现，当服务器没有响应时，Applet向另一个服务器转发请求。这种方法的透明性不好，Applet向各服务器查询来收集信息会增加额外的网络流量，不具有普遍的适用性。</p>
      <p><a name="N10080"><span class="smalltitle">2.3. 基于应用层负载均衡调度的解决方法</span></a></p>
      
      <p>多台服务器通过高速的互联网络连接成一个集群系统，在前端有一个基于应用层的负载调度器。当用户访问请求到达调度器时，请求会提交给作负载均衡调度的应用程序，分析请求，根据各个服务器的负载情况，选出一台服务器，重写请求并向选出的服务器访问，取得结果后，再返回给用户。</p>
      <p>应用层负载均衡调度的典型代表有Zeus负载调度器[4]、pWeb[5]、Reverse-Proxy[6]和SWEB[7]等。Zeus负载调度器是Zeus公司的商业产品，它是在Zeus Web服务器程序改写而成的，采用单进程事件驱动的服务器结构。pWeb就是一个基于Apache 1.1服务器程序改写而成的并行WEB调度程序，当一个HTTP请求到达时，pWeb会选出一个服务器，重写请求并向这个服务器发出改写后的请求，等结果返回后，再将结果转发给客户。Reverse-Proxy利用Apache 1.3.1中的Proxy模块和Rewrite模块实现一个可伸缩WEB服务器，它与pWeb的不同之处在于它要先从Proxy的cache中查找后，若没有这个副本，再选一台服务器，向服务器发送请求，再将服务器返回的结果转发给客户。SWEB是利用HTTP中的redirect错误代码，将客户请求到达一台WEB服务器后，这个WEB服务器根据自己的负载情况，自己处理请求，或者通过redirect错误代码将客户引到另一台WEB服务器，以实现一个可伸缩的WEB服务器。</p>
      <p>基于应用层负载均衡调度的多服务器解决方法也存在一些问题。第一，系统处理开销特别大，致使系统的伸缩性有限。当请求到达负载均衡调度器至处理结束时，调度器需要进行四次从核心到用户空间或从用户空间到核心空间的上下文切换和内存复制；需要进行二次TCP连接，一次是从用户到调度器，另一次是从调度器到真实服务器；需要对请求进行分析和重写。这些处理都需要不小的ＣＰＵ、内存和网络等资源开销，且处理时间长。所构成系统的性能不能接近线性增加的，一般服务器组增至3或4台时，调度器本身可能会成为新的瓶颈。所以，这种基于应用层负载均衡调度的方法的伸缩性极其有限。第二，基于应用层的负载均衡调度器对于不同的应用，需要写不同的调度器。以上几个系统都是基于HTTP协议，若对于FTP、Mail、POP3等应用，都需要重写调度器。</p>
      <p><a name="N10091"><span class="smalltitle">2.4. 基于IP层负载均衡调度的解决方法</span></a></p>
      
      <p>用户通过虚拟IP地址（Virtual IP Address）访问服务时，访问请求的报文会到达负载调度器，由它进行负载均衡调度，从一组真实服务器选出一个，将报文的目标地址Virtual IP Address改写成选定服务器的地址，报文的目标端口改写成选定服务器的相应端口，最后将报文发送给选定的服务器。真实服务器的回应报文经过负载调度器时，将报文的源地址和源端口改为Virtual IP Address和相应的端口，再把报文发给用户。Berkeley的MagicRouter[8]、Cisco的LocalDirector、Alteon的ACEDirector和F5的Big/IP等都是使用网络地址转换方法。MagicRouter是在Linux 1.3版本上应用快速报文插入技术，使得进行负载均衡调度的用户进程访问网络设备接近核心空间的速度，降低了上下文切换的处理开销，但并不彻底，它只是研究的原型系统，没有成为有用的系统存活下来。Cisco的LocalDirector、Alteon的ACEDirector和F5的Big/IP是非常昂贵的商品化系统，它们支持部分TCP/UDP协议，有些在ICMP处理上存在问题。</p>
      <p>IBM的TCP Router[9]使用修改过的网络地址转换方法在SP/2系统实现可伸缩的WEB服务器。TCP Router修改请求报文的目标地址并把它转发给选出的服务器，服务器能把响应报文的源地址置为TCP Router地址而非自己的地址。这种方法的好处是响应报文可以直接返回给客户，坏处是每台服务器的操作系统内核都需要修改。IBM的NetDispatcher[10]是TCP Router的后继者，它将报文转发给服务器，而服务器在non-ARP的设备配置路由器的地址。这种方法与LVS集群中的VS/DR类似，它具有很高的可伸缩性，但一套在IBM SP/2和NetDispatcher需要上百万美金。总的来说，IBM的技术还挺不错的。</p>
      <p>在贝尔实验室的ONE-IP[11]中，每台服务器都独立的IP地址，但都用IP Alias配置上同一VIP地址，采用路由和广播两种方法分发请求，服务器收到请求后按VIP地址处理请求，并以VIP为源地址返回结果。这种方法也是为了避免回应报文的重写，但是每台服务器用IP Alias配置上同一VIP地址，会导致地址冲突，有些操作系统会出现网络失效。通过广播分发请求，同样需要修改服务器操作系统的源码来过滤报文，使得只有一台服务器处理广播来的请求。</p>
      <p>微软的Windows NT负载均衡服务（Windows NT Load Balancing Service，WLBS）[12]是1998年底收购Valence Research公司获得的，它与ONE-IP中的基于本地过滤方法一样。WLBS作为过滤器运行在网卡驱动程序和TCP/IP协议栈之间，获得目标地址为VIP的报文，它的过滤算法检查报文的源IP地址和端口号，保证只有一台服务器将报文交给上一层处理。但是，当有新结点加入和有结点失效时，所有服务器需要协商一个新的过滤算法，这会导致所有有Session的连接中断。同时，WLBS需要所有的服务器有相同的配置，如网卡速度和处理能力。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link ibm-back-to-top"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a name="3"><span class="atitle">通过NAT实现虚拟服务器（VS/NAT）</span></a></p>
      
      <p>由于IPv4中IP地址空间的日益紧张和安全方面的原因，很多网络使用保留IP地址（10.0.0.0/255.0.0.0、172.16.0.0/255.128.0.0和192.168.0.0/255.255.0.0）[64, 65, 66]。这些地址不在Internet上使用，而是专门为内部网络预留的。当内部网络中的主机要访问Internet或被Internet访问时，就需要采用网络地址转换（Network Address Translation, 以下简称NAT），将内部地址转化为Internets上可用的外部地址。NAT的工作原理是报文头（目标地址、源地址和端口等）被正确改写后，客户相信它们连接一个IP地址，而不同IP地址的服务器组也认为它们是与客户直接相连的。由此，可以用NAT方法将不同IP地址的并行网络服务变成在一个IP地址上的一个虚拟服务。</p>
      <p>VS/NAT的体系结构如图2所示。在一组服务器前有一个调度器，它们是通过Switch/HUB相连接的。这些服务器提供相同的网络服务、相同的内容，即不管请求被发送到哪一台服务器，执行结果是一样的。服务的内容可以复制到每台服务器的本地硬盘上，可以通过网络文件系统（如NFS）共享，也可以通过一个分布式文件系统来提供。</p>
      
        <br><a name="N100B5"><b>图2：VS/NAT的体系结构</b></a><br>
        <img alt="VS/NAT的体系结构" height="541" src="./Linux服务器集群系统(三)_files/vs-nat.jpg" width="580">
      <br>
      <p>客户通过Virtual IP Address（虚拟服务的IP地址）访问网络服务时，请求报文到达调度器，调度器根据连接调度算法从一组真实服务器中选出一台服务器，将报文的目标地址Virtual IP Address改写成选定服务器的地址，报文的目标端口改写成选定服务器的相应端口，最后将修改后的报文发送给选出的服务器。同时，调度器在连接Hash表中记录这个连接，当这个连接的下一个报文到达时，从连接Hash表中可以得到原选定服务器的地址和端口，进行同样的改写操作，并将报文传给原选定的服务器。当来自真实服务器的响应报文经过调度器时，调度器将报文的源地址和源端口改为Virtual IP Address和相应的端口，再把报文发给用户。我们在连接上引入一个状态机，不同的报文会使得连接处于不同的状态，不同的状态有不同的超时值。在TCP连接中，根据标准的TCP有限状态机进行状态迁移，这里我们不一一叙述，请参见W. Richard Stevens的《TCP/IP Illustrated Volume I》；在UDP中，我们只设置一个UDP状态。不同状态的超时值是可以设置的，在缺省情况下，SYN状态的超时为1分钟，ESTABLISHED状态的超时为15分钟，FIN状态的超时为1分钟；UDP状态的超时为5分钟。当连接终止或超时，调度器将这个连接从连接Hash表中删除。</p>
      <p>这样，客户所看到的只是在Virtual IP Address上提供的服务，而服务器集群的结构对用户是透明的。对改写后的报文，应用增量调整Checksum的算法调整TCP Checksum的值，避免了扫描整个报文来计算Checksum的开销。</p>
      <p>在一些网络服务中，它们将IP地址或者端口号在报文的数据中传送，若我们只对报文头的IP地址和端口号作转换，这样就会出现不一致性，服务会中断。所以，针对这些服务，需要编写相应的应用模块来转换报文数据中的IP地址或者端口号。我们所知道有这个问题的网络服务有FTP、IRC、H.323、CUSeeMe、Real Audio、Real Video、Vxtreme / Vosiac、VDOLive、VIVOActive、True Speech、RSTP、PPTP、StreamWorks、NTT AudioLink、NTT SoftwareVision、Yamaha MIDPlug、iChat Pager、Quake和Diablo。</p>
      <p>下面，举个例子来进一步说明VS/NAT，如图3所示：</p>
      
        <br><a name="N100D1"><b>图3：VS/NAT的例子</b></a><br>
        <img alt="VS/NAT的例子" height="332" src="./Linux服务器集群系统(三)_files/vs-nat-example.jpg" width="389">
      <br>
      <p>VS/NAT的配置如下表所示，所有到IP地址为202.103.106.5和端口为80的流量都被负载均衡地调度的真实服务器172.16.0.2:80和172.16.0.3:8000上。目标地址为202.103.106.5:21的报文被转移到172.16.0.3:21上。而到其他端口的报文将被拒绝。</p>
      <table border="1" cellpadding="0" cellspacing="0" class="ibm-data-table"><tbody><tr><td valign="top" width="103">Protocol</td><td valign="top" width="173">Virtual IP Address</td><td valign="top" width="58">Port</td><td valign="top" width="167">Real IP Address</td><td valign="top" width="58">Port</td><td valign="top" width="84">Weight</td></tr><tr><td rowspan="2" valign="top" width="103">TCP</td><td rowspan="2" valign="top" width="173">202.103.106.5</td><td rowspan="2" valign="top" width="58">80</td><td valign="top" width="167">172.16.0.2</td><td valign="top" width="58">80</td><td valign="top" width="84">1</td></tr><tr><td valign="top" width="167">172.16.0.3</td><td valign="top" width="58">8000</td><td valign="top" width="84">2</td></tr><tr><td valign="top" width="103">TCP</td><td valign="top" width="173">202.103.106.5</td><td valign="top" width="58">21</td><td valign="top" width="167">172.16.0.3</td><td valign="top" width="58">21</td><td valign="top" width="84">1</td></tr></tbody></table>
      <p>从以下的例子中，我们可以更详细地了解报文改写的流程。</p>
      <p>访问Web服务的报文可能有以下的源地址和目标地址：</p>
      <table border="1" cellpadding="0" cellspacing="0" class="ibm-data-table"><tbody><tr><td valign="top" width="149">SOURCE</td><td valign="top" width="175">202.100.1.2:3456</td><td valign="top" width="158">DEST</td><td valign="top" width="166">202.103.106.5:80</td></tr></tbody></table>
      <p>调度器从调度列表中选出一台服务器，例如是172.16.0.3:8000。该报文会被改写为如下地址，并将它发送给选出的服务器。</p>
      <table border="1" cellpadding="0" cellspacing="0" class="ibm-data-table"><tbody><tr><td valign="top" width="149">SOURCE</td><td valign="top" width="175">202.100.1.2:3456</td><td valign="top" width="158">DEST</td><td valign="top" width="166">172.16.0.3:8000</td></tr></tbody></table>
      <p>从服务器返回到调度器的响应报文如下：</p>
      <table border="1" cellpadding="0" cellspacing="0" class="ibm-data-table"><tbody><tr><td valign="top" width="149">SOURCE</td><td valign="top" width="175">172.16.0.3:8000</td><td valign="top" width="158">DEST</td><td valign="top" width="166">202.100.1.2:3456</td></tr></tbody></table>
      <p>响应报文的源地址会被改写为虚拟服务的地址，再将报文发送给客户：</p>
      <table border="1" cellpadding="0" cellspacing="0" class="ibm-data-table"><tbody><tr><td valign="top" width="149">SOURCE</td><td valign="top" width="175">202.103.106.5:80</td><td valign="top" width="158">DEST</td><td valign="top" width="166">202.100.1.2:3456</td></tr></tbody></table>
      <p>这样，客户认为是从202.103.106.5:80服务得到正确的响应，而不会知道该请求是服务器172.16.0.2还是服务器172.16.0.3处理的。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link ibm-back-to-top"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a name="4"><span class="atitle">通过IP隧道实现虚拟服务器（VS/TUN）</span></a></p>
      
      <p>在VS/NAT的集群系统中，请求和响应的数据报文都需要通过负载调度器，当真实服务器的数目在10台和20台之间时，负载调度器将成为整个集群系统的新瓶颈。大多数Internet服务都有这样的特点：请求报文较短而响应报文往往包含大量的数据。如果能将请求和响应分开处理，即在负载调度器中只负责调度请求而响应直接返回给客户，将极大地提高整个集群系统的吞吐量。</p>
      <p>IP隧道（IP tunneling）是将一个IP报文封装在另一个IP报文的技术，这可以使得目标为一个IP地址的数据报文能被封装和转发到另一个IP地址。IP隧道技术亦称为IP封装技术（IP encapsulation）。IP隧道主要用于移动主机和虚拟私有网络（Virtual Private Network），在其中隧道都是静态建立的，隧道一端有一个IP地址，另一端也有唯一的IP地址。</p>
      <p>我们利用IP隧道技术将请求报文封装转发给后端服务器，响应报文能从后端服务器直接返回给客户。但在这里，后端服务器有一组而非一个，所以我们不可能静态地建立一一对应的隧道，而是动态地选择一台服务器，将请求报文封装和转发给选出的服务器。这样，我们可以利用IP隧道的原理将一组服务器上的网络服务组成在一个IP地址上的虚拟网络服务。VS/TUN的体系结构如图4所示，各个服务器将VIP地址配置在自己的IP隧道设备上。</p>
      
        <br><a name="N10203"><b>图4：VS/TUN的体系结构</b></a><br>
        <img alt="VS/TUN的体系结构" height="553" src="./Linux服务器集群系统(三)_files/vs-tun.jpg" width="580">
      <br>
      <p>VS/TUN的工作流程如图5所示：它的连接调度和管理与VS/NAT中的一样，只是它的报文转发方法不同。调度器根据各个服务器的负载情况，动态地选择一台服务器，将请求报文封装在另一个IP报文中，再将封装后的IP报文转发给选出的服务器；服务器收到报文后，先将报文解封获得原来目标地址为VIP的报文，服务器发现VIP地址被配置在本地的IP隧道设备上，所以就处理这个请求，然后根据路由表将响应报文直接返回给客户。</p>
      
        <br><a name="N10216"><b>图5：VS/TUN的工作流程</b></a><br>
        <img alt="VS/TUN的工作流程" height="349" src="./Linux服务器集群系统(三)_files/vs-tun-flow.jpg" width="547">
      <br>
      <p>在这里需要指出，根据缺省的TCP/IP协议栈处理，请求报文的目标地址为VIP，响应报文的源地址肯定也为VIP，所以响应报文不需要作任何修改，可以直接返回给客户，客户认为得到正常的服务，而不会知道究竟是哪一台服务器处理的。</p>
      
        <br><a name="N10229"><b>图6：半连接的TCP有限状态机</b></a><br>
        <img alt="半连接的TCP有限状态机" height="319" src="./Linux服务器集群系统(三)_files/half-stm.jpg" width="422">
      <br>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link ibm-back-to-top"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a name="5"><span class="atitle">通过直接路由实现虚拟服务器（VS/DR）</span></a></p>
      
      <p>跟VS/TUN方法相同，VS/DR利用大多数Internet服务的非对称特点，负载调度器中只负责调度请求，而服务器直接将响应返回给客户，可以极大地提高整个集群系统的吞吐量。该方法与IBM的NetDispatcher产品中使用的方法类似（其中服务器上的IP地址配置方法是相似的），但IBM的NetDispatcher是非常昂贵的商品化产品，我们也不知道它内部所使用的机制，其中有些是IBM的专利。</p>
      <p>VS/DR的体系结构如图7所示：调度器和服务器组都必须在物理上有一个网卡通过不分断的局域网相连，如通过高速的交换机或者HUB相连。VIP地址为调度器和服务器组共享，调度器配置的VIP地址是对外可见的，用于接收虚拟服务的请求报文；所有的服务器把VIP地址配置在各自的Non-ARP网络设备上，它对外面是不可见的，只是用于处理目标地址为VIP的网络请求。</p>
      
        <br><a name="N10247"><b>图7：VS/DR的体系结构</b></a><br>
        <img alt="VS/DR的体系结构" height="555" src="./Linux服务器集群系统(三)_files/vs-dr.jpg" width="580">
      <br>
      <p>VS/DR的工作流程如图8所示：它的连接调度和管理与VS/NAT和VS/TUN中的一样，它的报文转发方法又有不同，将报文直接路由给目标服务器。在VS/DR中，调度器根据各个服务器的负载情况，动态地选择一台服务器，不修改也不封装IP报文，而是将数据帧的MAC地址改为选出服务器的MAC地址，再将修改后的数据帧在与服务器组的局域网上发送。因为数据帧的MAC地址是选出的服务器，所以服务器肯定可以收到这个数据帧，从中可以获得该IP报文。当服务器发现报文的目标地址VIP是在本地的网络设备上，服务器处理这个报文，然后根据路由表将响应报文直接返回给客户。</p>
      
        <br><a name="N1025A"><b>图8：VS/DR的工作流程</b></a><br>
        <img alt="VS/DR的工作流程" height="339" src="./Linux服务器集群系统(三)_files/vs-dr-flow.jpg" width="580">
      <br>
      <p>在VS/DR中，根据缺省的TCP/IP协议栈处理，请求报文的目标地址为VIP，响应报文的源地址肯定也为VIP，所以响应报文不需要作任何修改，可以直接返回给客户，客户认为得到正常的服务，而不会知道是哪一台服务器处理的。</p>
      <p>VS/DR负载调度器跟VS/TUN一样只处于从客户到服务器的半连接中，按照半连接的TCP有限状态机进行状态迁移。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link ibm-back-to-top"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a name="6"><span class="atitle">三种方法的优缺点比较</span></a></p>
      
      <p>三种IP负载均衡技术的优缺点归纳在下表中：</p>
      <table border="1" cellpadding="0" cellspacing="0" class="ibm-data-table"><tbody><tr><td width="175">_</td><td width="149">VS/NAT</td><td width="140">VS/TUN</td><td width="149">VS/DR</td></tr><tr><td width="175">Server</td><td width="149">any</td><td width="140">Tunneling</td><td width="149">Non-arp device</td></tr><tr><td width="175">server network</td><td width="149">private</td><td width="140">LAN/WAN</td><td width="149">LAN</td></tr><tr><td width="175">server number</td><td width="149">low (10~20)</td><td width="140">High (100)</td><td width="149">High (100)</td></tr><tr><td>server gateway</td><td>load balancer</td><td width="140">own router</td><td width="149">Own router</td></tr></tbody></table>
      <p>注：以上三种方法所能支持最大服务器数目的估计是假设调度器使用100M网卡，调度器的硬件配置与后端服务器的硬件配置相同，而且是对一般Web服务。使用更高的硬件配置（如千兆网卡和更快的处理器）作为调度器，调度器所能调度的服务器数量会相应增加。当应用不同时，服务器的数目也会相应地改变。所以，以上数据估计主要是为三种方法的伸缩性进行量化比较。</p>
      <p><a name="N102E1"><span class="smalltitle">6.1. Virtual Server via NAT</span></a></p>
      
      <p>VS/NAT的优点是服务器可以运行任何支持TCP/IP的操作系统，它只需要一个IP地址配置在调度器上，服务器组可以用私有的IP地址。缺点是它的伸缩能力有限，当服务器结点数目升到20时，调度器本身有可能成为系统的新瓶颈，因为在VS/NAT中请求和响应报文都需要通过负载调度器。 我们在Pentium 166 处理器的主机上测得重写报文的平均延时为60us，性能更高的处理器上延时会短一些。假设TCP报文的平均长度为536 Bytes，则调度器的最大吞吐量为8.93 MBytes/s. 我们再假设每台服务器的吞吐量为800KBytes/s，这样一个调度器可以带动10台服务器。（注：这是很早以前测得的数据）</p>
      <p>基于VS/NAT的的集群系统可以适合许多服务器的性能要求。如果负载调度器成为系统新的瓶颈，可以有三种方法解决这个问题：混合方法、VS/TUN和VS/DR。在DNS混合集群系统中，有若干个VS/NAT负载调度器，每个负载调度器带自己的服务器集群，同时这些负载调度器又通过RR-DNS组成简单的域名。但VS/TUN和VS/DR是提高系统吞吐量的更好方法。</p>
      <p>对于那些将IP地址或者端口号在报文数据中传送的网络服务，需要编写相应的应用模块来转换报文数据中的IP地址或者端口号。这会带来实现的工作量，同时应用模块检查报文的开销会降低系统的吞吐率。</p>
      <p><a name="N102F2"><span class="smalltitle">6.2. Virtual Server via IP Tunneling</span></a></p>
      
      <p>在VS/TUN的集群系统中，负载调度器只将请求调度到不同的后端服务器，后端服务器将应答的数据直接返回给用户。这样，负载调度器就可以处理大量的请求，它甚至可以调度百台以上的服务器（同等规模的服务器），而它不会成为系统的瓶颈。即使负载调度器只有100Mbps的全双工网卡，整个系统的最大吞吐量可超过1Gbps。所以，VS/TUN可以极大地增加负载调度器调度的服务器数量。VS/TUN调度器可以调度上百台服务器，而它本身不会成为系统的瓶颈，可以用来构建高性能的超级服务器。</p>
      <p>VS/TUN技术对服务器有要求，即所有的服务器必须支持“IP Tunneling”或者“IP Encapsulation”协议。目前，VS/TUN的后端服务器主要运行Linux操作系统，我们没对其他操作系统进行测试。因为“IP Tunneling”正成为各个操作系统的标准协议，所以VS/TUN应该会适用运行其他操作系统的后端服务器。</p>
      <p><a name="N10300"><span class="smalltitle">6.3. Virtual Server via Direct Routing</span></a></p>
      
      <p>跟VS/TUN方法一样，VS/DR调度器只处理客户到服务器端的连接，响应数据可以直接从独立的网络路由返回给客户。这可以极大地提高LVS集群系统的伸缩性。</p>
      <p>跟VS/TUN相比，这种方法没有IP隧道的开销，但是要求负载调度器与实际服务器都有一块网卡连在同一物理网段上，服务器网络设备（或者设备别名）不作ARP响应，或者能将报文重定向（Redirect）到本地的Socket端口上。</p>
      <div class="ibm-alternate-rule"><hr></div><p class="ibm-ind-link ibm-back-to-top"><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon" class="ibm-anchor-up-link">回页首</a></p><p><a name="7"><span class="atitle">小结</span></a></p>
      
      <p>本文主要讲述了LVS集群中的三种IP负载均衡技术。在分析网络地址转换方法（VS/NAT）的缺点和网络服务的非对称性的基础上，我们给出了通过IP隧道实现虚拟服务器的方法VS/TUN，和通过直接路由实现虚拟服务器的方法VS/DR，极大地提高了系统的伸缩性。</p>
    <!-- CMA ID: 22087 --> <!-- Site ID: 10 --> <!-- XSLT stylesheet used to transform this file: dw-document-html-6.0.xsl -->
<br>
<p><a name="resources"><span class="atitle">参考资料 </span></a></p>
      <ol>
        <li>Eric Dean Katz, Michelle Butler, and Robert McGrath, "A Scalable HTTP Server: The NCSA Prototype", Computer Networks and ISDN Systems, pp155-163, 1994.</li>
        <li>Thomas T. Kwan, Robert E. McGrath, and Daniel A. Reed, "NCSA's World Wide Web Server: Design and Performance", IEEE Computer, pp68-74, November 1995.</li>
        <li>C. Yoshikawa, B. Chun, P. Eastham, A. Vahdat, T. Anderson, and D. Culler. Using Smart Clients to Build Scalable Services. In Proceedings of the 1997 USENIX Technical Conference, January 1997.</li>
        <li>Zeus Technology, Inc. Zeus Load Balancer v1.1 User Guide.
          <a href="http://www.zeus.com/">http://www.zeus.com/</a>
        </li>
        
        <li>Ralf S.Engelschall. Load Balancing Your Web Site: Practical Approaches for Distributing HTTP Traffic. Web Techniques Magazine, Volume 3, Issue 5, http://www.webtechniques.com, May 1998.</li>
        
        <li>Eric Anderson, Dave Patterson, and Eric Brewer, "The Magicrouter: an Application of Fast Packet Interposing",
          <a href="http://www.cs.berkeley.edu/~eanders-/magicrouter/">http://www.cs.berkeley.edu/~eanders-/magicrouter/</a>, May, 1996.
        </li>
        <li>D. Dias, W. Kish, R. Mukherjee, and R. Tewari. A Scalable and Highly Available Server. In Proceeding of COMPCON 1996, IEEE-CS Press, Santa Clara, CA, USA, Febuary 1996, pp. 85-92.</li>
        <li>Guerney D.H. Hunt, German S. Goldszmidt, Richard P. King, and Rajat Mukherjee. Network Dispatcher: a connection router for scalable Internet services. In Proceedings of the 7th International WWW Conference, Brisbane, Australia, April 1998.</li>
        
        <li>Microsoft Corporation. Microsoft Windows NT Load Balancing Service.
          <a href="http://www.micorsoft.com/ntserver/NTServerEnterprise/exec/feature/WLBS/">http://www.micorsoft.com/ntserver/NTServerEnterprise/exec/feature/WLBS/</a>.
        </li>
      </ol>
<p><a name="author"><span class="atitle">关于作者</span></a></p><div class="ibm-container ibm-portrait-module ibm-alternate-two"><div class="ibm-container-body"><p><a name="author1"> </a>章文嵩博士，开放源码及Linux内核的开发者，著名的Linux集群项目－－LVS(Linux Virtual
Server)的创始人和主要开发人员。他目前工作于国家并行与分布式处理重点实验室，主要从事集群技术、操作系统、对象存储与数据库的研究。他一直在自由软件的开发上花费大量时间，并以此为乐。</p></div></div>
<!-- MAIN_COLUMN_CONTENT_END -->

  <!-- INLINE_COMMENTS_START -->
  <p class="ibm-no-print"><span class="atitle"><a name="icomments">建议</a></span></p>
  <div id="dw-icomments-container" class="ibm-no-print">
    <div class="ibm-alternate-rule"><hr></div>
    <div class="ibm-alternate-rule"><hr></div>
    <!-- Comment_Script -->
    
    <a id="comments" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/comments"></a>
    <script language="JavaScript" type="text/javascript">
      // <![CDATA[
dwc = {};
dwc.cmts = '条评论';
dwc.signIn = '登录';
dwc.addCmts = '添加评论';
dwc.addCmt = '添加评论';
dwc.viewOrAddCmts = '查看或添加评论';
dwc.reportInapprCont = '举报不良信息';
dwc.reportInapprContLink = 'http://www.ibm.com/developerworks/forums/forum.jspa?forumID=1834';
dwc.postingCmt = '正在发布评论……';
dwc.noCmt = '快来添加第一条评论';
dwc.netwkErr = '在检索评论时出错，请稍后刷新。';
dwc.addACmt = '添加评论';
dwc.instructCmt = '标有星号（<span class="ibm-required">*</span>）的是必填项目。';
dwc.cmt = '评论：';
dwc.btnPost = '发布';
dwc.btnPostAnon = '匿名发布';
dwc.btnClrCmt = '清除评论';
dwc.btnCancel = '取消';
dwc.showRecent = '显示最新的 {1} 条评论'; // {1} is the count to be substituted
dwc.showNext = '显示后 {1} 条评论'; // {1} is the count to be substituted
dwc.showAllCmts = '显示所有评论';
dwc.enterCmt = '请输入评论内容。';
dwc.loginErr = '暂时无法验证您的登录状态，请稍后再试。';
dwc.postErr = '暂时无法发布您的评论，请稍后再试。';
dwc.postBy = '由 <b>{1}</b>  于 {2} '; // {1} is the author to be substituted; {2} is the date
dwc.siteId = 10;
dwc.lang = 'zh_CN';
// ]]>
    </script>
    <script language="JavaScript" src="./Linux服务器集群系统(三)_files/insertcomment.js" type="text/javascript">//</script>
    <div id="threadShow"><div id="cmtTog" style=""><p><span id="numCmts">0</span>&nbsp;条评论 <span class="dw-bar">|</span> <a class="loginLk" style="display: none; " href="https://www.ibm.com/developerworks/dwwi/DWAuthRouter?m=loginpage&lang=zh_CN&d=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Flinux%2Fcluster%2Flvs%2Fpart3%2F%23icomments">登录</a><a id="addCmtLk" class="dw-icomment-link">添加评论</a><a class="dw-icomment-report" href="http://www.ibm.com/developerworks/forums/forum.jspa?forumID=1834">举报不良信息</a></p><div class="ibm-alternate-rule"><hr></div><div id="commentForm" style="display: none; "><div class="ibm-container"><h2>添加评论</h2><div class="ibm-container-body"><p>标有星号（<span class="ibm-required">*</span>）的是必填项目。</p><span id="infoCmt"></span><div class="ibm-rule"><hr></div><form method="post" action="" class="ibm-column-form" enctype="multipart/form-data" focus="name" name="form"><p><label for="newCmt">评论：<span class="ibm-required">*</span></label><br><textarea name="newCmt" id="newCmt" cols="120" rows="4"></textarea></p><div class="ibm-alternate-rule"><hr></div><p class="ibm-buttons-row"><input value="发布" type="button" name="postCmt" class="ibm-btn-arrow-sec" id="postCmt"><span class="ibm-sep">&nbsp;</span><input value="清除评论" type="button" name="clearCmt" class="ibm-btn-cancel-sec" id="clearCmt"><span class="ibm-sep">&nbsp;</span><input value="取消" type="button" name="cancelCmt" class="ibm-btn-cancel-sec" id="cancelCmt"></p></form></div></div></div><div id="cmtSect"><div class="comment"><div class="dw-icomment-container"><table class="dw-icomment-body" cellpadding="0" cellspacing="0" width="100%"><tbody><tr><td><p>快来添加第一条评论</p></td></tr></tbody></table></div></div></div><div id="paging"><p><a id="lastCmts" class="dw-icomment-link" style="display: none; ">显示最新的 5 条评论</a><span id="cmtDivider" style="display: none; "> <span class="dw-bar">|</span> </span><a id="nextCmts" class="dw-icomment-link" style="display: none; ">显示后 5 条评论</a><span id="cmtDivider2" style="display: none; "> <span class="dw-bar">|</span> </span><a id="viewAllCmts" class="dw-icomment-link" style="display: none; ">显示所有评论</a></p></div><p><a class="loginLk" style="display: none; " href="https://www.ibm.com/developerworks/dwwi/DWAuthRouter?m=loginpage&lang=zh_CN&d=https%3A%2F%2Fwww.ibm.com%2Fdeveloperworks%2Fcn%2Flinux%2Fcluster%2Flvs%2Fpart3%2F%23icomments">登录</a><a id="addCmtLk2" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#icomments">添加评论</a></p><div class="ibm-alternate-rule"><hr></div><div class="ibm-alternate-rule"><hr></div></div></div>
    <script language="JavaScript" type="text/javascript">
      // <![CDATA[
jQuery('threadShow').insertComment('95%',5,'nCmts','icomments');
// ]]>
    </script>
  </div>
  <!-- INLINE_COMMENTS_END -->
  

  <p class="ibm-ind-link ibm-back-to-top"><a class="ibm-anchor-up-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#ibm-pcon">回页首</a></p>
  <p><a href="http://www.ibm.com/developerworks/cn/ibm/trademarks/">商标</a> &nbsp;|&nbsp; <a href="http://www.ibm.com/developerworks/cn/mydw_terms/">My developerWorks 使用条款与条件</a></p>

<!-- Overlays -->
<!-- lk - pull in overlays from ww when required on cn -->
  </div>
<!-- MAIN_COLUMN_CONTAINER_END -->

<!-- Rating_Meta_BEGIN -->
<!--Rating_Meta_BEGIN--><div class="metavalue">static.content.url=http://www.ibm.com/developerworks/js/artrating/</div><div class="metavalue">SITE_ID=10</div><div class="metavalue">Zone=Linux</div><div class="metavalue">ArticleID=22087</div><div class="metavalue">ArticleTitle=Linux服务器集群系统(三)</div><div class="metavalue">publish-date=04102002</div><div class="metavalue">author1-email=wensong@linux-vs.org</div><div class="metavalue">author1-email-cc=wensong@linux-vs.org</div><script language="javascript" type="text/javascript">document.write('<div class="metavalue">url='+location.href.replace('<', '%3C')+'</div>');</script><div class="metavalue">url=https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/</div><!--Rating_Meta_END-->
<!-- Rating_Meta_END -->

</div>
<!-- MAIN_COLUMN_END-->

<!-- RIGHT_COLUMN_BEGIN -->
<div id="ibm-content-sidebar">

<!-- RIGHT_COLUMN_CONTENT_BEGIN --> 
<div class="ibm-container"><h2>内容</h2><div class="ibm-container-body"><img alt="" height="1" width="1" src="./Linux服务器集群系统(三)_files/c(1).gif"><ul class="ibm-bullet-list"><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#1">前言</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#2">实现虚拟服务的相关方法</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#3">通过NAT实现虚拟服务器（VS/NAT）</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#4">通过IP隧道实现虚拟服务器（VS/TUN）</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#5">通过直接路由实现虚拟服务器（VS/DR）</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#6">三种方法的优缺点比较</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#7">小结</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#resources">参考资料 </a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#author">关于作者</a></li><li><a class="ibm-feature-link" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#icomments">建议</a></li></ul></div></div>

 

<!-- Tagging_Start -->
<div id="dw-tag-cloud-container" class="ibm-container dw-hidetag"><h2>标签</h2>
<div id="dw-tag-help"><a class="dwauthor" rel="#tagtip" id="dwtagtip"><img alt="Help" height="16" width="16" align="top" src="./Linux服务器集群系统(三)_files/help_icon.gif"></a></div>
<div id="tagtip" class="dwauthor-onload-state ibm-no-print" style="display: none; ">使用 <strong>搜索</strong> 文本框在 My developerWorks 中查找包含该标签的所有内容。<p>使用 <strong>滑动条</strong> 调节标签的数量。</p><p><strong>热门标签</strong> 显示了特定专区最受欢迎的标签（例如 Java technology，Linux，WebSphere）。</p><p><strong>我的标签&lt; /strong&gt; 显示了特定专区您标记的标签（例如 Java technology，Linux，WebSphere）。</strong></p></div><strong>
<div class="ibm-access">使用搜索文本框在 My developerWorks 中查找包含该标签的所有内容。<em>热门标签</em> 显示了特定专区最受欢迎的标签（例如 Java technology，Linux，WebSphere）。<em>我的标签</em> 显示了特定专区您标记的标签（例如 Java technology，Linux，WebSphere）。</div>
<div class="ibm-container-body">
<div class="dw-tag-search"><form action="https://www.ibm.com/developerworks/mydeveloperworks/bookmarks/html" method="get" id="actualtagform" onsubmit="popupform(this, &#39;join&#39;)">
<p><label for="tagfield"><strong>搜索所有标签</strong></label>
<input type="hidden" name="lang" value="zh">
<input id="tagfield" name="tag" type="text" maxlength="20" size="17">&nbsp;<input src="./Linux服务器集群系统(三)_files/short-btn.gif" type="image" class="ibm-btn-view" alt="submit search" title="提交搜索" value="Search"></p></form></div>
<div class="ibm-rule"><hr></div>
<div id="dw-tag-select">
<div id="dw-tag-select-popular"><p><strong>热门文章标签</strong>&nbsp;|&nbsp;<br><a id="a-my" href="javascript:;">我的文章标签</a><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#dw-tag-access" class="ibm-access">跳转到标签列表</a></p></div>
<div id="dw-tag-select-my" class="dw-hidetag"><p><a id="a-popular" href="javascript:;">热门文章标签</a>&nbsp;|&nbsp;<br><strong>我的文章标签</strong></p><a href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#dw-tag-access" class="ibm-access">跳转到标签列表</a></div>
<div id="dw-tag-cloud"></div>  
</div>   
</div>
</strong></div><strong>
<!-- Tagging_End -->

<!-- Dig_Deeper -->

<!-- High_Visibility_Offer -->

<!-- Special_Offers -->

<!-- RIGHT_COLUMN_CONTENT_END -->

</strong></div><strong>
<!-- RIGHT_COLUMN_END -->

<!-- CONTENT_BODY_END -->
</strong></div><strong>

</strong></div><strong>
<!-- CONTENT_END -->

 <!-- END_IBM-PCON -->
</strong></div><strong>

<!-- FOOTER_BEGIN -->
<div id="ibm-page-tools">
<!-- IBM page tools container -->
</div>
<div id="ibm-footer">
<ul>
<li class="ibm-first"><a href="http://www.ibm.com/ibm/cn/zh/">关于IBM</a></li>
<li><a href="http://www.ibm.com/privacy/cn/zh/">隐私条约</a></li>
<li><a href="http://www.ibm.com/contact/cn/zh/">联系IBM</a></li>
<li><a href="http://www.ibm.com/legal/cn/zh/">使用条款</a></li>
<li><a href="http://www.ibm.com/ibm/syndication/cn/zh/">IBM RSS 可定制阅读服务</a></li><li><a href="https://www.ibm.com/employment/cn/">求才启事</a></li></ul>
<div id="ibm-social-tools"><ul><li><a class="ibm-share-print" title="打印本页面" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" rel="print"></a></li><li><a class="ibm-share-email" title="用电子邮件发送本页面" href="https://www.ibm.com/developerworks/cn/linux/cluster/lvs/part3/#" rel="email"></a></li></ul></div></div>
<!-- FOOTER_END -->

 <!-- END_IBM-TOP -->
</strong><div id="ibm-overlay-top"></div></div><strong>
 
 <!-- SCRIPTS_INCLUDE_BEGIN -->
<!-- JQuery start -->
<script type="text/javascript" language="JavaScript" src="./Linux服务器集群系统(三)_files/jquery.dimensions-1.2.js"></script>
<script type="text/javascript" language="JavaScript" src="./Linux服务器集群系统(三)_files/jquery.hoverIntent.minified.js"></script>
<script type="text/javascript" language="JavaScript" src="./Linux服务器集群系统(三)_files/jquery.cluetip.js"></script>
<script type="text/javascript" language="JavaScript">
	jQuery.noConflict();     
	// Put all your code in your document ready area
	jQuery(document).ready(function(jQuery) {
	// Do jQuery stuff using jQuery 
	jQuery('a.dwauthor').cluetip({
		local: true,
		showTitle: false,
		positionBy: 'bottomTop',
		sticky: true,	
		mouseOutClose: true,
		closeText: '<img src="//dw1.s81c.com/developerworks/js/jquery/cluetip98/i/x.gif" alt="Close" />',
		arrows: false,
		dropShadow: true,
		cluetipClass: 'dwbasic'
		});   	
	});
 </script>
 <!-- JQuery end --><!-- BEGIN: Use this section to set page specific variables for the Unica Page Tag -->
<script language="JavaScript">var NTPT_PGEXTRA="ibmSkillLevel=1&ibmAdoptPhase=667&ibmRole=710";</script>
<!--END --><!-- SCRIPTS_INCLUDE_END -->

<div id="ibm-metrics">
<script src="./Linux服务器集群系统(三)_files/stats.js" type="text/javascript">//</script>
</div>



</strong><div id="cluetip-waitimage" style="position: absolute; z-index: 95; display: none; "></div><div id="cluetip" style="display: none; position: absolute; z-index: 96; "><div style="z-index: 95; opacity: 0.1; top: 1px; left: 1px; position: absolute; background-color: rgb(0, 0, 0); "></div><div style="z-index: 94; opacity: 0.1; top: 2px; left: 2px; position: absolute; background-color: rgb(0, 0, 0); "></div><div style="z-index: 93; opacity: 0.1; top: 3px; left: 3px; position: absolute; background-color: rgb(0, 0, 0); "></div><div style="z-index: 92; opacity: 0.1; top: 4px; left: 4px; position: absolute; background-color: rgb(0, 0, 0); "></div><div style="z-index: 91; opacity: 0.1; top: 5px; left: 5px; position: absolute; background-color: rgb(0, 0, 0); "></div><div style="z-index: 90; opacity: 0.1; top: 6px; left: 6px; position: absolute; background-color: rgb(0, 0, 0); "></div><div id="cluetip-outer" style="position: relative; z-index: 97; "><h3 id="cluetip-title"></h3><div id="cluetip-inner"></div></div><div id="cluetip-extra"></div><div id="cluetip-arrows" class="cluetip-arrows" style="z-index: 97; "></div></div></body></html>